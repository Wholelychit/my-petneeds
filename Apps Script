function onFormSubmit(e) {
  const sheet = e.range.getSheet();
  const row = e.range.getRow();

  // CHANGE these numbers if your columns differ
  const photoColumn = 6; // file upload column number
  const imageUrlColumn = 10; // "Image URL" column

  const fileLinks = sheet.getRange(row, photoColumn).getValue();
  if (!fileLinks) return;

  const fileId = fileLinks.match(/[-\w]{25,}/);
  if (!fileId) return;

  const file = DriveApp.getFileById(fileId[0]);
  file.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);

  const publicUrl = `https://drive.google.com/uc?id=${fileId[0]}`;
  sheet.getRange(row, imageUrlColumn).setValue(publicUrl);
}
